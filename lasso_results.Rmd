```{r}
library(regmed)
library(dplyr)
library(haven)
source("./lasso_mediation.R")
```

```{r}
#Fit results for female prosocial behavior 
plot.regmed.grid(fit_female_hapsoc)
female_hapsoc_fit_best <- regmed.grid.bestfit(fit_female_hapsoc)
summary(female_hapsoc_fit_best)
#One non-zero coefficient 
edges.med.f.hapsoc <- regmed.edges(female_hapsoc_fit_best, type = "mediators")
plot.regmed.edges(edges.med.f.hapsoc)
#Effect not large enough to mediate
```

```{r}
#Fit results for female hyperactivity 
plot.regmed.grid(fit_female_hahypr)
female_hahypr_fit_best <- regmed.grid.bestfit(fit_female_hahypr)
summary(female_hahypr_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for female emotional problems  
plot.regmed.grid(fit_female_haemot)
female_haemot_fit_best <- regmed.grid.bestfit(fit_female_haemot)
summary(female_haemot_fit_best)
#One non-zero coefficient 
edges.med.f.haemot <- regmed.edges(female_haemot_fit_best, type = "mediators")
plot.regmed.edges(edges.med.f.haemot)
#Effect not large enough to mediate
```

```{r}
#Fit results for female peer problems  
plot.regmed.grid(fit_female_hapeer)
female_hapeer_fit_best <- regmed.grid.bestfit(fit_female_hapeer)
summary(female_hapeer_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for female conduct problems 
plot.regmed.grid(fit_female_hacondb)
female_hacondb_fit_best <- regmed.grid.bestfit(fit_female_hacondb)
summary(female_hacondb_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for female total SDQ score  
plot.regmed.grid(fit_female_hasdqtb)
female_hasdqtb_fit_best <- regmed.grid.bestfit(fit_female_hasdqtb)
summary(female_hasdqtb_fit_best)
#All coefficients are 0 
```
```{r}
#Fit results for male prosocial behavior 
plot.regmed.grid(fit_male_hapsoc)
male_hapsoc_fit_best <- regmed.grid.bestfit(fit_male_hapsoc)
summary(male_hapsoc_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for male hyperactivity 
plot.regmed.grid(fit_male_hahypr)
male_hahypr_fit_best <- regmed.grid.bestfit(fit_male_hahypr)
summary(male_hahypr_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for male emotional problems  
plot.regmed.grid(fit_male_haemot)
male_haemot_fit_best <- regmed.grid.bestfit(fit_male_haemot)
summary(male_haemot_fit_best)
#One non-zero coefficient 
edges.med.m.haemot <- regmed.edges(male_haemot_fit_best, type = "mediators")
plot.regmed.edges(edges.med.m.haemot)
#Effect not large enough to mediate
```

```{r}
#Fit results for male peer problems  
plot.regmed.grid(fit_male_hapeer)
male_hapeer_fit_best <- regmed.grid.bestfit(fit_male_hapeer)
summary(male_hapeer_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for male conduct problems 
plot.regmed.grid(fit_male_hacondb)
male_hacondb_fit_best <- regmed.grid.bestfit(fit_male_hacondb)
summary(male_hacondb_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for male total SDQ score  
plot.regmed.grid(fit_male_hasdqtb)
male_hasdqtb_fit_best <- regmed.grid.bestfit(fit_male_hasdqtb)
summary(male_hasdqtb_fit_best)
#All coefficients are 0 
```

```{r}
#Fit results for female prosocial behavior 
plot.regmed.grid(fit_female_hapsoc_single)
female_hapsoc_fit_best_single <- regmed.grid.bestfit(fit_female_hapsoc_single)
summary(female_hapsoc_fit_best_single)
#One non-zero coefficient 
edges.med.f.hapsoc_single <- regmed.edges(female_hapsoc_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.f.hapsoc_single)
#
```

```{r}
#Fit results for female hyperactivity 
plot.regmed.grid(fit_female_hahypr_single)
female_hahypr_fit_best_single <- regmed.grid.bestfit(fit_female_hahypr_single)
summary(female_hahypr_fit_best_single)
#One non-zero coefficient 
edges.med.f.hahypr_single <- regmed.edges(female_hahypr_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.f.hahypr_single)
#Effect not large enough to be significant 
```

```{r}
#Fit results for female emotional problems  
plot.regmed.grid(fit_female_haemot_single)
female_haemot_fit_best_single <- regmed.grid.bestfit(fit_female_haemot_single)
summary(female_haemot_fit_best_single)
#All coefficients are 0 
```

```{r}
#Fit results for female peer problems  
plot.regmed.grid(fit_female_hapeer_single)
female_hapeer_fit_best_single <- regmed.grid.bestfit(fit_female_hapeer_single)
summary(female_hapeer_fit_best_single)
#One non-zero coefficient 
edges.med.f.hapeer_single <- regmed.edges(female_hapeer_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.f.hapeer_single)
#Effect not large enough to be significant 
```

```{r}
#Fit results for female conduct problems 
plot.regmed.grid(fit_female_hacondb_single)
female_hacondb_fit_best_single <- regmed.grid.bestfit(fit_female_hacondb_single)
summary(female_hacondb_fit_best_single)
#One non-zero coefficient 
edges.med.f.hacondb_single <- regmed.edges(female_hacondb_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.f.hacondb_single)
#
```

```{r}
#Fit results for female total SDQ score  
plot.regmed.grid(fit_female_hasdqtb_single)
female_hasdqtb_fit_best_single <- regmed.grid.bestfit(fit_female_hasdqtb_single)
summary(female_hasdqtb_fit_best_single)
#One non-zero coefficient 
edges.med.f.hasdqtb_single <- regmed.edges(female_hasdqtb_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.f.hasdqtb_single)
```

```{r}
#Fit results for male prosocial behavior 
plot.regmed.grid(fit_male_hapsoc_single)
male_hapsoc_fit_best_single <- regmed.grid.bestfit(fit_male_hapsoc_single)
summary(male_hapsoc_fit_best_single)
#All coefficients are 0 
```

```{r}
#Fit results for male hyperactivity 
plot.regmed.grid(fit_male_hahypr_single)
male_hahypr_fit_best_single <- regmed.grid.bestfit(fit_male_hahypr_single)
summary(male_hahypr_fit_best_single)
#All coefficients are 0 
```

```{r}
#Fit results for male emotional problems  
plot.regmed.grid(fit_male_haemot_single)
male_haemot_fit_best_single <- regmed.grid.bestfit(fit_male_haemot_single)
summary(male_haemot_fit_best_single)
#One non-zero coefficient 
edges.med.m.haemot_single <- regmed.edges(male_haemot_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.m.haemot_single)
```

```{r}
#Fit results for male peer problems  
plot.regmed.grid(fit_male_hapeer_single)
male_hapeer_fit_best_single <- regmed.grid.bestfit(fit_male_hapeer_single)
summary(male_hapeer_fit_best_single)
#One non-zero coefficient 
edges.med.m.hapeer_single <- regmed.edges(male_hapeer_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.m.hapeer_single)
#Effect not large enough to be significant 
```

```{r}
#Fit results for male conduct problems 
plot.regmed.grid(fit_male_hacondb_single)
male_hacondb_fit_best_single <- regmed.grid.bestfit(fit_male_hacondb_single)
summary(male_hacondb_fit_best_single)
#Two non-zero coefficient (education-based SB and screen time)
edges.med.m.hacondb_single <- regmed.edges(male_hacondb_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.m.hacondb_single)
#Effects not large enough to be significant 
```

```{r}
#Fit results for male total SDQ score  
plot.regmed.grid(fit_male_hasdqtb_single)
male_hasdqtb_fit_best_single <- regmed.grid.bestfit(fit_male_hasdqtb_single)
summary(male_hasdqtb_fit_best_single)
#One non-zero coefficient 
edges.med.m.hasdqtb_single <- regmed.edges(male_hasdqtb_fit_best_single, type = "mediators")
plot.regmed.edges(edges.med.m.hasdqtb_single)
```

```{r}
#Fit results for female prosocial behavior 
plot.regmed.grid(fit_female_hapsoc_two)
female_hapsoc_fit_best_two <- regmed.grid.bestfit(fit_female_hapsoc_two)
summary(female_hapsoc_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for female hyperactivity 
plot.regmed.grid(fit_female_hahypr_two)
female_hahypr_fit_best_two <- regmed.grid.bestfit(fit_female_hahypr_two)
summary(female_hahypr_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for female emotional problems  
plot.regmed.grid(fit_female_haemot_two)
female_haemot_fit_best_two <- regmed.grid.bestfit(fit_female_haemot_two)
summary(female_haemot_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for female peer problems  
plot.regmed.grid(fit_female_hapeer_two)
female_hapeer_fit_best_two <- regmed.grid.bestfit(fit_female_hapeer_two)
summary(female_hapeer_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for female conduct problems 
plot.regmed.grid(fit_female_hacondb_two)
female_hacondb_fit_best_two <- regmed.grid.bestfit(fit_female_hacondb_two)
summary(female_hacondb_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for female total SDQ score  
plot.regmed.grid(fit_female_hasdqtb_two)
female_hasdqtb_fit_best_two <- regmed.grid.bestfit(fit_female_hasdqtb_two)
summary(female_hasdqtb_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for male prosocial behavior 
plot.regmed.grid(fit_male_hapsoc_two)
male_hapsoc_fit_best_two <- regmed.grid.bestfit(fit_male_hapsoc_two)
summary(male_hapsoc_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for male hyperactivity 
plot.regmed.grid(fit_male_hahypr_two)
male_hahypr_fit_best_two <- regmed.grid.bestfit(fit_male_hahypr_two)
summary(male_hahypr_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for male emotional problems  
plot.regmed.grid(fit_male_haemot_two)
male_haemot_fit_best_two <- regmed.grid.bestfit(fit_male_haemot_two)
summary(male_haemot_fit_best_two)
#2V3V6V7V12 - very tiny mediation interaction of naps, education, screen time, self-care, and household LPA
#All other coefficients are 0 
```

```{r}
#Fit results for male peer problems  
plot.regmed.grid(fit_male_hapeer_two)
male_hapeer_fit_best_two <- regmed.grid.bestfit(fit_male_hapeer_two)
summary(male_hapeer_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for male conduct problems 
plot.regmed.grid(fit_male_hacondb_two)
male_hacondb_fit_best_two <- regmed.grid.bestfit(fit_male_hacondb_two)
summary(male_hacondb_fit_best_two)
#All coefficients are 0 
```

```{r}
#Fit results for male total SDQ score  
plot.regmed.grid(fit_male_hasdqtb_two)
male_hasdqtb_fit_best_two <- regmed.grid.bestfit(fit_male_hasdqtb_two)
summary(male_hasdqtb_fit_best_two)
#All coefficients are 0 
```